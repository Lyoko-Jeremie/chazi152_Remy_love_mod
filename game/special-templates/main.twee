:: Test
<<location "flats">><<effects>>
<<endcombat>>
<<link [[测试|Test]]>><</link>>
<br><br>

<<pass 60>>

:: Robin
<<set $NPCName[$NPCNameList.indexOf("Robin")].love to 50>>
<<if $NPCName[$NPCNameList.indexOf("Robin")].love gte 50>>
<</if>>
<<nnpc_he Robin>>

<<link [["问" + $NPCList[0].pronouns.him + "是怎么进出的"|Prison Wren Ask 2]]>><</link>>

<<run Furniture.set('owlplushie', 'owlplushie', {
	name	: 'owl plushie',
	nameCap	: 'Owl plushie'
})>>

:: Sex
<<if $sexstart is 1>>
	<<set $sexstart to 0>>
	<<consensual>>
	<<set $consensual to 1>>
	<<neutral 1>>
	<<maninit>>
	<<set $enemytrust += 100>><<promiscuity5>>
<</if>>

<<effects>>
<<effectsman>>
<<man>>
<<stateman>>
<br><br>
<<actionsman>>
<<if _combatend>>
	<span id="next"><<link [[继续|Sex Finish]]>><</link>></span><<nexttext>>
<<else>>
	<span id="next"><<link [[继续|Sex]]>><</link>></span><<nexttext>>
<</if>>

:: Sex Finish

<<set $outside to 0>><<effects>>
<<if $enemyarousal gte $enemyarousalmax>>
	<<ejaculation>>
	人物高潮后续的文本。
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Sex]]>><</link>>/*Point links wherever you want the player to end up*/
<<elseif $enemyhealth lte 0>>
	逃跑的文本。
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Sex]]>><</link>>
<<else>>
	关于遭遇的文本停止，因为你结束了它。
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Sex]]>><</link>>
<</if>>

:: Rape

<<if $molestationstart is 1>>
	<<set $molestationstart to 0>>
	<<controlloss>>
	<<violence 1>>
	<<neutral 1>>
	<<molested>>
	<<maninit>>
	<<enable_rescue>>/*Remove line if rescue is impossible*/
<</if>>

<<effects>>
<<effectsman>>
<<alarmstate>>
<<man>>
<<stateman>>
<br><br>
<<actionsman>>

<<if _combatend>>
	<span id="next"><<link [[继续|Rape Finish]]>><</link>></span><<nexttext>>
<<else>>
	<span id="next"><<link [[继续|Rape]]>><</link>></span><<nexttext>>
<</if>>

:: Rape Finish
<<effects>>
<<if $enemyarousal gte $enemyarousalmax>>
	<<ejaculation>>
	人物高潮后续的文本。
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Rape]]>><<set $molestationstart to 1>><</link>>/*Link points wherever you want the player to end up*/

<<elseif $enemyhealth lte 0>>
	逃跑的文本。
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Rape]]>><<set $molestationstart to 1>><</link>>

<<else>>
	<<set $rescued += 1>>/*Unnecessary if rescue is impossible*/
	被救的相关文本。
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Rape]]>><<set $molestationstart to 1>><</link>>

<</if>>

:: Fight
<<if $fightstart is 1>>
	<<set $fightstart to 0>>
	<<neutral 1>>
	<<maninit>>
	<<set $enemytrust -= 100>>
	<<set $enemyanger += 200>>
	<<npcidlegenitals>>
<</if>>

<<effects>>
<<effectsman>>
<<man>>
<<stateman>>
<br><br>
<<actionsman>>

<<if _combatend or ($pain gte 100 and $willpowerpain is 0)>>
	<span id="next"><<link [[继续|Fight Finish]]>><</link>></span><<nexttext>>
<<else>>
	<span id="next"><<link [[继续|Fight]]>><</link>></span><<nexttext>>
<</if>>

:: Fight Finish
<<effects>>
<<if $enemyarousal gte $enemyarousalmax>>
	<<ejaculation>>
	人物高潮后续的文本。
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Fight]]>><</link>>/*Point links wherever you want the player to end up*/

<<elseif $enemyhealth lte 0>>
	逃跑的文本。
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Fight]]>><</link>>

<<else>>
	伤得太重不能打的相关文本。
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Fight]]>><</link>>

<</if>>

:: Skulduggery
<<effects>>

<<set $skulduggerydifficulty to 200>>
<<link [[继续|Skulduggery 2]]>><</link>><<skulduggerydifficulty>>
<br>

:: Skulduggery 2
<<effects>>

描述你进行尝试的可能性文本。
<br><br>

<<skulduggerycheck>>
<<if $skulduggerysuccess is 1>>

	描述你成功的文本。
	<br><br>

	<<if $skulduggery lte ($skulduggerydifficulty + 100)>>
		<<skulduggeryskilluse>>
	<<else>>
		<span class="blue">这对你来说实在是太简单了，你从中什么都没有学到。</span>
		<br><br>
	<</if>>

	<<link [[继续|Skulduggery]]>><</link>>
	<br>

<<else>>

	描述你失败的文本。
	<br><br>

	<<if $skulduggery lte ($skulduggerydifficulty + 100)>>
		<<skulduggeryskilluse>>
	<<else>>
		<span class="blue">这对你来说实在是太简单了，你从中什么都没有学到。</span>
		<br><br>
	<</if>>

	<<link [[继续|Skulduggery]]>><</link>>
	<br>

<</if>>

:: Beast Sex
<<if $sexstart is 1>>
	<<set $sexstart to 0>>
	<<consensual>>
	<<set $consensual to 1>>
	<<neutral 1>>
	<<beastNEWinit 1 dog>>/* - Delete if beasts are already generated*/
	<<beastCombatInit>>
	<<beastTrainGenerate>>/* - Delete if there aren't multiple beasts*/
<</if>>

<<effects>>
<<effectsman>>
<br>
<<beast $enemyno>>
<br><br>

<<stateman>>
<br><br>
<<actionsman>>

<<if _combatend>>
	<span id="next"><<link [[继续|Beast Sex Finish]]>><</link>></span><<nexttext>>
<<else>>
	<span id="next"><<link [[继续|Beast Sex]]>><</link>></span><<nexttext>>
<</if>>

:: Beast Sex Finish
<<effects>>

<<if $enemyarousal gte $enemyarousalmax>>

	<<beastejaculation>>

	野兽交配后续的插入文本。
	<br><br>

	<<tearful>>你振作起来。
	<br><br>

	<<clotheson>>
	<<endcombat>>

	<<link [[继续|Beast Rape]]>><<set $eventskip to 1>><</link>>

<<elseif $enemyhealth lte 0>>

	野兽奔跑的插入文本。
	<br><br>

	<<tearful>>你振作起来。
	<br><br>

	<<clotheson>>
	<<endcombat>>

	<<link [[继续|Beast Rape]]>><<set $eventskip to 1>><</link>>

<<else>>

	野兽因你的要求而停止的插入文本。
	<br><br>

	<<tearful>>你振作起来。
	<br><br>

	<<clotheson>>
	<<endcombat>>

	<<link [[继续|Beast Rape]]>><<set $eventskip to 1>><</link>>

<</if>>

:: Beast Rape
<<if $molestationstart is 1>>
	<<set $molestationstart to 0>>
	<<controlloss>>
	<<violence 1>>
	<<neutral 1>>
	<<molested>>
	<<beastNEWinit 2 dog>>/* - Delete if beasts are already generated*/
	<<beastCombatInit>>
	<<beastTrainGenerate>>/* - Delete if there aren't multiple beasts*/
<</if>>

<<effects>>
<<effectsman>>
<br><br>
<<beast $enemyno>>
<br><br>

<<stateman>>
<br><br>
<<actionsman>>

<<if _combatend>>
	<span id="next"><<link [[继续|Beast Rape Finish]]>><</link>></span><<nexttext>>
<<else>>
	<span id="next"><<link [[继续|Beast Rape]]>><</link>></span><<nexttext>>
<</if>>

:: Beast Rape Finish
<<effects>>

<<if $enemyarousal gte $enemyarousalmax>>

	<<beastejaculation>>

	野兽交配后续的插入文本。
	<br><br>

	<<tearful>>你振作起来。
	<br><br>

	<<clotheson>>
	<<endcombat>>

	<<link [[继续|Beast Rape]]>><<set $eventskip to 1>><</link>>

<<elseif $enemyhealth lte 0>>

	野兽奔跑的插入文本。
	<br><br>

	<<tearful>>你振作起来。
	<br><br>

	<<clotheson>>
	<<endcombat>>

	<<link [[继续|Beast Rape]]>><<set $eventskip to 1>><</link>>

<<else>><<set $rescued += 1>>

	获救的插入文本。
	<br><br>

	<<tearful>>你振作起来。
	<br><br>

	<<clotheson>>
	<<endcombat>>

	<<link [[继续|Beast Rape]]>><<set $eventskip to 1>><</link>>

<</if>>

:: Beast Gang
<<if $molestationstart is 1>>
	<<set $molestationstart to 0>>
	<<controlloss>>
	<<violence 1>>
	<<neutral 1>>
	<<molested>>
	<<beastNEWinit 1 wolf>>
	<<beastCombatInit>>
	<<beastTrainGenerate>>
	<<enable_rescue>>/*optional*/
<</if>>
<<effects>>
<<effectsman>>
<<alarmstate>>
<<beast $enemyno>>
<br><br>
<<stateman>>
<br><br>
<<actionsman>>

<<if _combatend>>
	<span id="next"><<link [[继续|Beast Gang End]]>><</link>></span><<nexttext>>
<<else>>
	<span id="next"><<link [[继续|Beast Gang]]>><</link>></span><<nexttext>>
<</if>>

:: Beast Gang End
<<effects>>
<<if $enemyhealth lte 0>>
	<<beastwound>>
	<<if $combatTrain.length gt 0>>
		<<beasttype>>吃痛退开，但另一个家伙跃跃欲试。

		<<combatTrainAdvance>>
		<br><br>
		<<link [[继续|Beast Gang]]>><</link>>
	<<else>>
		<<beasttype>>吃痛退开。
		<<combatTrainAdvance>>
		<br><br>
		<<link [[继续|Beast Gang End]]>><<set $finish to 1>><</link>>
	<</if>>
<<elseif $enemyarousal gte $enemyarousalmax>>
	<<beastejaculation>>
	<<if $combatTrain.length gt 0>>
		在满足之后，<<beasttype>>离开了。该轮到下一位了。

		<<combatTrainAdvance>>
		<br><br>
		<<link [[继续|Beast Gang]]>><</link>>
	<<else>>
		心满意足之后，那只<<beasttype>>离开了你。
		<<combatTrainAdvance>>
		<br><br>
		<<link [[继续|Beast Gang End]]>><<set $finish to 1>><</link>>
	<</if>>
<<elseif $finish is 1>>
	<<if $enemywounded is 1 and $enemyejaculated is 0>>
		<<beasttype>>呜咽着逃走了。
	<<elseif $enemywounded is 0 and $enemyejaculated is 1>>
		心满意足的<<beasttype>>离开了。
	<<elseif $enemywounded gte 2 and $enemyejaculated is 0>>
		由于你的奋力抵抗，感到无趣的野兽离开了。
	<<elseif $enemywounded is 0 and $enemyejaculated gte 2>>
		野兽抛下了你，你现在疲惫不堪，身体发软。
	<<elseif $enemywounded gte 1 and $enemyejaculated gte 1>>
		野兽抛下了你，你现在疲惫不堪，身体发软。
	<</if>>
	<br><br>
	<<tearful>>你振作起来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<destinationeventend>>
<<elseif $alarm is 1 and $rescue is 1>>
	<<set $rescued += 1>>

	你得救了。
	<br><br>
	<<tearful>>你振作起来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<destinationeventend>>
<</if>>

:: Seduce
<<effects>>

<<set $seductiondifficulty to 6000>>
<<seductioncheck>>
<br><br>
<<if $seductionskill lt 1000>>
	<span class="gold">你对自己的诱惑力更有信心了。</span>
	<br><br>
<</if>>
<<seductionskilluse>>

详细描述你企图引诱的文本。
<<promiscuity3>>

<<if $seductionrating gte $seductionrequired>>

	详细描述你勾引成功的文本。
	<br><br>

<<else>>

	详细描述你引诱失败的文本。
	<br><br>

<</if>>

:: Lock

<<set $lock to 300>>

这扇门紧锁着。
<br><br>

	<<if currentSkillValue('skulduggery') gte $lock>>
	<span class="green">这把锁看起来很容易撬开。</span>
	<br><br>

	<<link [[闯入(0:05)|Elk Compound Interior]]>><<pass 5>><<crimeup 1>><</link>><<crime>>
	<br>
	<<else>>
	<span class="red">这个锁看起来已经超出了你的能力范围。</span><<skulduggeryrequired>>
	<br><br>
	<</if>>

你成功地撬开锁并进到了楼内。
<<set $compoundcentre to 1>><<set $compoundalarm += 1>>

<<if $skulduggery lt 400>>
<<skulduggeryskilluse>>
<<else>>
<span class="blue">你无法从这么简单的锁中学到更多技巧。</span>
<</if>>

:: Template for a widget that outputs text based on character's state

<<widget "widgetname">>
	<<exposure>>/*Makes sure your clothing state is up to date*/
	<<if $optionalvariable is "something">>
		<<if $trauma gte (($traumamax / 5) * 4)>>
			<<if $stress gte (($stressmax / 5) * 4)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<elseif $stress gte (($stressmax / 5) * 1)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<else>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<</if>>
		<<elseif $trauma gte (($traumamax / 5) * 1)>>
			<<if $stress gte (($stressmax / 5) * 4)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<elseif $stress gte (($stressmax / 5) * 1)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<else>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<</if>>
		<<else>>
			<<if $stress gte (($stressmax / 5) * 4)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<elseif $stress gte (($stressmax / 5) * 1)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<else>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<</if>>
		<</if>>
	<<else>>
		<<if $trauma gte (($traumamax / 5) * 4)>>
			<<if $stress gte (($stressmax / 5) * 4)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<elseif $stress gte (($stressmax / 5) * 1)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<else>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<</if>>
		<<elseif $trauma gte (($traumamax / 5) * 1)>>
			<<if $stress gte (($stressmax / 5) * 4)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<elseif $stress gte (($stressmax / 5) * 1)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<else>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<</if>>
		<<else>>
			<<if $stress gte (($stressmax / 5) * 4)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<elseif $stress gte (($stressmax / 5) * 1)>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<<else>>
				<<if $arousal gte (($arousalmax / 5) * 4)>>

				<<elseif $arousal gte (($arousalmax / 5) * 1)>>

				<<else>>

				<</if>>
			<</if>>
		<</if>>
	<</if>>
<</widget>>

<<set $danger to random(1, 10000)>><<set $dangerevent to 0>>
	<<if $danger gte (9900 - $allure)>>

	<<else>>

	<</if>>

<<if $test is "" or $test is undefined>><<set $test to "default">><</if>>
<<textbox "$test" $test>>

<<if $physique gte $rng * 100 + 6000>>

<</if>>

		<<if $npcspeechcycle is 0>>
		<<He>>开口说道，""
		<<elseif $npcspeechcycle is 1>>
		<<He>>开口说道，""
		<<elseif $npcspeechcycle is 2>>
		<<He>>开口说道，""
		<<elseif $npcspeechcycle is 3>>
		<<He>>开口说道，""
		<<elseif $npcspeechcycle is 4>>
		<<He>>开口说道，""
		<<elseif $npcspeechcycle is 5>>
		<<He>>开口说道，""
		<<else>>
		<<He>>开口说道，""
		<</if>>

:: Save and load NPC
<<generate1>><<generate2>>
<<saveNPC 0 "john">>
<<saveNPC 1 "jane">>
<<endevent>>

<<loadNPC 0 "john">><<person1>>
<<loadNPC 1 "jane">><<person2>>

<<endevent>>

<<if $per_npc.john isnot undefined>>
	<<loadNPC 0 "john">><<person1>>
	<<endevent>>
<</if>>
<<if $per_npc.jane isnot undefined>>
	<<loadNPC 0 "jane">><<person1>>
	<<endevent>>
<</if>>

<<clearNPC "john">>
<<clearNPC "jane">>

:: Misc

$NPCName[$NPCNameList.indexOf("Robin")].love
<<npcincr Robin love 1>>

<<for _i to 0; _i lt $NPCName.length; _i++>>
<</for>>

<<set $antiquemoney += 40>><<museumAntiqueStatus "antiqueforestdagger" "found">>

/*To capitalise the first letter of a string:*/
<<print $string>>

/*Using .length with a generic object*/
<<set _skin_keys to Object.keys(setup.bodywriting)>>
<<for _s to 0; _s lt _skin_keys.length; _s++>>
	<<print setup.bodywriting[_skin_keys[_s]].writ_cn>>
	<br>
<</for>>

:: Tentacles
<<effects>>

<<if $molestationstart is 1>>
	<<set $molestationstart to 0>>
	<<set $combat to 1>>
	<<set $enemytype to "tentacles">>
	<<molested>>
	<<controlloss>>

	<<tentaclestart 8 15>>

<</if>>

<<statetentacles>>


<<effects>>
<<effectstentacles>>
<<tentacles>>
<<actionstentacles>>

<<if $tentacles.active lte ($tentacles.max / 2)>>
	<span id="next"><<link [[继续|Tentacles Finish]]>><</link>></span><<nexttext>>
<<else>>
	<span id="next"><<link [[继续|Tentacles]]>><</link>></span><<nexttext>>
<</if>>

:: Tentacles Finish
<<effects>>

逃脱/被触手抛下的描述。
<br><br>

<<tearful>>你逃掉了。
<br><br>

<<clotheson>>
<<endcombat>>

<<link [[继续|Tentacles]]>><</link>>
<br>

/*How to destroy a cursed item, replacing "face" with the slot in question:*/
<<set $worn.face.type.push("broken")>>
<<faceruined>>

<<if $exposed gte 2 and $exhibitionism lt 95 or $exposed gte 2 and $uncomfortable.nude is true>>

<<else>>

<</if>>

:: Masturbation

<<effects>>
<<if $masturbationstart is 1>>
	<<set $masturbationstart to 0>>
	<<set $masturbationstat += 1>>
	<<masturbationstart>>
<</if>>
<<masturbationeffects>>
<<masturbationactions>>

<div id="masturbationButtons">
	<div id="next"><<link [[继续|Masturbation]]>><</link>><<nexttext>></div>

	<div><<link [[停止|Masturbation Finish]]>><<set $finish to 1>><</link>></div>
</div>
<br>

:: Masturbation Finish

<<effects>>
关于结束自慰的选择文本。
<br><br>

<<endmasturbation>>
<<endcombat>>

<<tearful>>你继续你的冒险。
<br><br>

<<link [[继续|Masturbation]]>><<clotheson>><</link>>
<br>

/*Splits text by NPC genitals and breastsize*/
<<if $NPCList[0].penis isnot "none">>
	<<if $NPCList[0].breastsize gte 3>>
		他们有阴茎和大小适中的胸部。
	<<else>>
		他们有阴茎，胸部很小。
	<</if>>
<<else>>
	<<if $NPCList[0].breastsize gte 3>>
		他们没有阴茎，胸部大小适中。
	<<else>>
		他们没有阴茎，胸部很小/平坦。
	<</if>>
<</if>>

:: Physique Check

<<physiquedifficulty arg1 arg2>>/*On previous passage after link. Displays the difficulty. First argument is the physique required to have any chance of success. Second argument is the physique required to have a 100% chance of success. Argument 1 defaults to 1 if left blank. Argument 2 defaults to $physiquemax if left blank, which is 20000 as of 0.2.9.0. Argument 3 accepts true and prevents any text from showing in cases where there are multiple checks of the same time in the previous passage*/

/*<<physiquedifficulty arg1 arg2 true>>Optional check just before here when there are multiple checks*/
<<if $physiqueSuccess>>/*Replace 1 and $physiquemax with whatever numbers/variables used as arguments in <<physiquedifficulty>>*/

通过体格检定的文本。

<<else>>

体能检定失败的文本。

<</if>>

:: Encounter Movements

<span class="blue"><<He>>将<<his>>的 $NPCList[_n].penisdesc放在你的嘴前。</span>
<<neutral 5 "mouth">><<set $mouthuse to "penis">><<set $NPCList[_n].penis to "mouthentrance">><<set $mouthstate to "entrance">><<set $speechmouthentrance to 1>><<set $mouthtarget to _n>>

<span class="purple"><<He>>用腿夹住你的头，把小穴压在你的嘴上。</span>
<<submission 5>><<set $mouthuse to "othervagina">><<set $NPCList[_n].vagina to "mouth">><<set $mouthstate to "othervagina">><<violence 3>><<bruise face>><<set $speechvaginamouth to 1>><<set $mouthtarget to _n>>

<span class="blue"><<He>>在你的双腿间来回摩挲着，同时将<<his>>的$NPCList[_n].penisdesc对准了你的<<pussy>>。</span>
<<neutral 5 "genitals">><<set $vaginause to "penis">><<set $NPCList[_n].penis to "vaginaentrance">><<set $vaginastate to "entrance">><<set $speechvaginaentrance to 1>><<set $vaginatarget to _n>>

<<set $penisuse to "othervagina">><<set $NPCList[_n].vagina to "penisentrance">><<set $penisstate to "entrance">><<set $penistarget to _n>>
<span class="blue"><<He>>跨坐在你的身上，将<<his>>的小穴紧贴在你的<<penis>>前端。</span>

<span class="blue"><<He>>在你的双腿间来回摩挲着，同时将<<his>>的$NPCList[_n].penisdesc对准了你的<<bottom>>。</span>
<<neutral 5 "bottom">><<set $anususe to "penis">><<set $NPCList[_n].penis to "anusentrance">><<set $anusstate to "entrance">><<set $speechanusentrance to 1>><<set $anustarget to _n>>

:: Monster Selection
<!-- Modified for Monster People -->
<<if ($monsterchance gte 1 and $hallucinations gte 1) or ($monsterchance gte 1 and $monsterhallucinations is "f")>>
	<<if maleChance() lt random(1, 100)>>
		怪物女孩
	<<else>>
		怪物男孩
	<</if>>
<<else>>
	野兽
<</if>>

:: Reminder of how to impact plants outside tending

<<set _garden_location to "garden">>
<<for _i to 0; _i lt $plots[_garden_location].length; _i++>>
	<<set _tending_temp to _i>>
	<<set $plots[_garden_location][_tending_temp].water to 1>>
<</for>>


:: Reminder of how to give plants to the player outside planting

<<tending_harvest red_rose medium 3>>


:: Machine

<<if $molestationstart is 1>>
	<<set $molestationstart to 0>>
	<<controlloss>>
	<<violence 1>>
	<<neutral 1>>

	<<set $machine_health to 10>><<set $machine_ammo to 3>>/*Used by following widget. Must be set.*/
	<<machine_init tattoo vaginal anal arm_chains leg_chains>>/*Include each machine type you want present as an argument*/
	<<set $machine.tattoo.armed to 1>>/*Remove if there's no tattoo gun, or you don't want the tattoo gun to be able to remove tattoos*/
	<<set $machine.vaginal.armed to 1>>/*Remove if there's no vaginal sex machine, or you don't want the sex machine to be able to easily destroy clothes.*/
	<<set $machine.anal.armed to 1>>
	<<prop rails table milk neck_shackle>>/*Delete props as appropriate*/
	<<set $bodywriting_special to "dungeon">>/*Makes all tattoos appropriate for dungeon. Remove for a broader range of tattoos.*/
<</if>>

<<effects>>

<<machine_effects>><<machine_combat>>
<<machine_state>>

/*Debug info. Remove from playable events*/
运行中的机器数量: <<print $machine.number>><br>
<br>
<<if $machine.tattoo>>
	纹身枪使用: <<print $machine.tattoo.use>><br>
	纹身枪状态: <<print $machine.tattoo.state>><br>
	纹身枪完好度: <<print $machine.tattoo.health>><br>
	纹身枪破损度: <<print $machine.tattoo.hack>><br>
<</if>>
<br>
<<if $machine.vaginal>>
	阴茎机械使用: <<print $machine.vaginal.use>><br>
	阴茎机械状态:<<print $machine.vaginal.state>><br>
	阴茎机械完好:<<print $machine.vaginal.health>><br>
	炮机破损度: <<print $machine.vaginal.hack>><br>
	炮机弹药: <<print $machine.vaginal.ammo>><br>
	炮机速度: <<print $machine.vaginal.speed>><br>
<</if>>
<br>
<<if $machine.anal>>
	小型炮机使用: <<print $machine.anal.use>><br>
	小型炮机状态: <<print $machine.anal.state>><br>
	小型炮机完好度: <<print $machine.anal.health>><br>
	小型炮机破损度: <<print $machine.anal.hack>><br>
	小型炮机弹药: <<print $machine.anal.ammo>><br>
	小型炮机速度: <<print $machine.anal.speed>><br>
<</if>>
<br>
<<if $machine.arm_chains>>
	臂链使用: <<print $machine.arm_chains.use>><br>
	臂链状态: <<print $machine.arm_chains.state>><br>
	臂链完好度: <<print $machine.arm_chains.health>><br>
	臂链破损度: <<print $machine.arm_chains.hack>><br>
<</if>>
<br>
<<if $machine.leg_chains>>
	腿链使用: <<print $machine.leg_chains.use>><br>
	腿链状态: <<print $machine.leg_chains.state>><br>
	腿链完好度: <<print $machine.leg_chains.health>><br>
	腿链破损度: <<print $machine.leg_chains.hack>><br>
<</if>>
/*Debug info end*/


<br><br>
<<machine_actions>>

<<if $machine.number lte 0 or $finish is 1>>
	<<link [[继续|Machine End]]>><</link>>
<<else>>
	<<link [[继续|Machine]]>><</link>>
	<<if $machine.vaginal or $machine.anal>>
		<br>
		<<if $machine.vaginal.speed is "high" or $machine.anal.speed is "high">>
			<<link [[减！速！|Machine]]>><<machine_speed "normal">><</link>>
		<<else>>
			<<link [[提！速！|Machine]]>><<machine_speed "high">><</link>>
		<</if>>
	<</if>>
<</if>>
<br>

<<link [[结束|Machine End]]>><</link>>
<br>


:: Machine End
<<effects>>

<<machine_end>>
<<clotheson>>

<<link [[机械|Machine]]>><<set $molestationstart to 1>><</link>>
<br>


:: Struggle
<<effects>>

<<if $struggle_start is 1>>
	<<struggle_init>>
	<<set $struggle.creature to "lurker">>/*Creature species*/
	<<struggle_creatures 5 2>>/*How many creatures will be involved, and their health.*/
	<<set $combat to 1>>
	<<controlloss>>
	<<violence 1>>
	<<molested>>
	<<set $struggle.mouth.creature to "lurker">><<set $mouthuse to "struggle">><<set $mouthstate to "struggle">><<set $struggle.enemy[0].location to "mouth">>/*Encounters can begin with a creature already attached to a body part. Optional.*/
	<<unset $struggle_start>>
<</if>>

<<if $condition is "met">>
	<<struggle_add 1 1>>/*Adds more creatures, with a specific health.*/
	<span class="pink">另一个生物发起了袭击！</span>
	<br><br>
<</if>>

<<struggle>>



<<if $struggle.done gte $struggle.number>>
	<span id="next"><<link [[继续|Struggle End]]>><</link>></span>
	<br>
<<else>>
	<span id="next"><<link [[继续|Struggle]]>><</link>></span>
	<br>
<</if>>


:: Struggle End
<<effects>>

有事发生了。
<br><br>

<<clotheson>>
<<endcombat>>

<<link [[继续|Struggle]]>><<set $struggle_start to 1>><</link>>
<br>

/*Farm stage reminders:
$farm_stage = 1: Alex met, farm work explained.
$farm_stage = 2: Farm work accepted. 1 field clear
$farm_stage = 3: Worked at the farm a little, harasser appeared.
$farm_stage = 4: 2 fields clear. Alex offered booze.
$farm_stage = 5: 3 fields clear. Remy threatened Alex.
$farm_stage = 6: 4 fields clear. Alex's parent visits.
$farm_stage = 7: Time passed since Alex's parent's visit. Bailey visits. Fields are now controlled by the player, steeds can be saddled, and Alex can be chosen as a love interest. Attacks begin. Wall can be upgraded.
$farm_stage = 8: 5 fields clear. More upgrades can be bought.
$farm_stage = 9: 6 fields clear. Lab unlocked. 1 phial available for PC to sell to compound.
$farm_stage = 10: 7 fields clear. "Hurl net" ability unlocked, and more phials can now be produced.
$farm_stage = 11: 8 fields clear. Strange flowers can now be grown.
$farm_stage = 12: 9 fields clear. Remy threatens again.
*/

/*
$kylar_camera = undefined: Event not started.
$kylar_camera = 0: Gift offered, not opened.
$kylar_camera = 1: Gift opened, not accepted.
$kylar_camera = 2: Gift accepted.
$kylar_camera = 3: Given to orphan.
$kylar_camera = 4: Camera discovered in bedroom.
$kylar_camera = 5: Camera discovered in living room.
$kylar_camera = 6: Camera removed.
$kylar_camera = 7: Camera left.
*/

:: Stalk

<<if $molestationstart is 1>>
	<<set $molestationstart to 0>>
	<<violence 1>>
	<<neutral 1>>
	<<maninit>>
	<<stalk_init>>
	<<if Time.dayState isnot "night">>
		<<enable_rescue>>/*Remove if rescue is impossible*/
	<</if>>
	<<set $location to "town">>
<</if>>

<<effects>>
<<effectsman>>
<<alarmstate>>
<<man>>
<<if $audience_active>>
	<<audience>>
<</if>>
<<stateman>>
<br><br>
<<actionsman>>

<<if _combatend or $stalk_end>>
	<span id="next"><<link [[继续|Stalk Finish]]>><</link>></span><<nexttext>>
<<else>>
	<span id="next"><<link [[继续|Stalk]]>><</link>></span><<nexttext>>
<</if>>

:: Stalk Finish
<<effects>>
<<if $enemyarousal gte $enemyarousalmax>>
	<<ejaculation>>
	<<if $combat_end_text>>
		<<print $combat_end_text>>
	<<else>>
		人物高潮后续的文本。
	<</if>>
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Stalk]]>><<set $molestationstart to 1>><</link>>/*Link points wherever you want the player to end up*/

<<elseif $enemyhealth lte 0>>
	逃跑的文本。
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Stalk]]>><<set $molestationstart to 1>><</link>>
<<elseif $stalk_end is "escaped">>
	你放慢脚步，<<tearful>>随后继续前进。
	<br><br>

	<<clotheson>>
	<<endcombat>>

	<<link [[继续|Stalk]]>><<set $molestationstart to 1>><</link>>
	<br>

<<elseif $stalk_end is "passed">>
	你深吸一口气，<<tearful>>你继续前进。
	<br><br>
	<<clotheson>>
	<<endcombat>>

	<<link [[继续|Stalk]]>><<set $molestationstart to 1>><</link>>
	<br>

<<elseif $stalk_end is "hide">>
	<<covered>><<tearful>>你离开藏身之处，继续着自己的行程。
	<br><br>

	<<set $stealtextskip to 1>>
	<<stealclothes>>
	<<clotheson>>
	<<endcombat>>

	<<link [[继续|Stalk]]>><<set $molestationstart to 1>><</link>>
	<br>
<<elseif $stalk_end is "outpaced">>/*Unnecessary if the PC can't become the pursuer */
	<<if $exposed gte 1>>
		<<switch $location>>
		<<case alley>>
			<<tearful>>你渐渐地慢了下来。<<covered>>周围没有任何人，但这里依旧是个公共场所。
		<<case forest lake>>
			<<tearful>>你渐渐地慢了下来。<<covered>>周围现在没人，但你也没法确保在森林里不会撞见别人。
		<<case moor>>
			<<tearful>>你渐渐地慢了下来。<<covered>>周围没有人，但无论怎样，在这么开阔的地方暴露身体总会让人有些害怕。
		<<default>>
			<<covered>><<tearful>>你潜入一条小巷，希望这能让你的身体免受其他人的视奸。
		<</switch>>
	<<else>>
		<<tearful>>你渐渐的慢了下来。
	<</if>>
	<br><br>
	<<set $stealtextskip to 1>>
	<<stealclothes>>
	<<clotheson>>
	<<endcombat>>

	<<link [[继续|Stalk]]>><<set $molestationstart to 1>><</link>>
	<br>
<<else>>
	<<set $rescued += 1>>/*Unnecessary if rescue is impossible*/
	<<if $position is "stalk">>
		被追捕时被救的文本。
	<<else>>
		被袭击时被救的文本。
	<</if>>
	<br><br>
	<<tearful>>你缓了过来。
	<br><br>
	<<clotheson>>
	<<endcombat>>
	<<link [[继续|Stalk]]>><<set $molestationstart to 1>><</link>>

<</if>>
<br><br>
<<link [[跑!!!|Domus Street]]>><<endevent>><</link>>
<br>

:: Dance
<<effects>>

<<if $dancestart is 1>>
	<<unset $dancestart>>
	<<danceinit>>
	<<set $dancing to 1>>
	<<set $audience to 25>>
	<<set $venuemod to 1>>
	<<set $dancelocation to "party">>
<</if>>

<<danceeffects>>
<<danceaudience>>
<<danceactions>>

<<if $corruptionDancing gt 0 and $danceevent is 0 and (($exhibitionism lte 74 and $exposed gte 2) or ($exhibitionism lte 34 and $exposed gte 1))>>
	你不能在穿着如此暴露的情况下跳舞。
<<elseif $danceevent is 0 and $exhibitionism lte 74 and $exposed gte 2>>
	你不可能在如此暴露的情况下继续跳舞！你满脸通红地逃离了现场。
	<br><br>
<<elseif $danceevent is 0 and $exhibitionism lte 34 and $exposed gte 1 and !$worn.under_lower.type.includes("dance")>>
	你不可能在如此暴露的情况下继续跳舞！你满脸通红地逃离了现场。
	<br><br>
<</if>>

<<if $danceevent is "finish">>
	<<unset $corruptionDancing>>
	<<link [[继续|Brothel]]>><<clotheson>><<endevent>><</link>>
<<elseif $danceevent is "private">>
	<<if $corruptionDancing is 2>>
		史莱姆希望你和更多人共享快乐的时光。
	<<elseif $promiscuity gte 35>>
		<<link [[包间|Brothel Private]]>><<set $phase to 0>><<set $enemyno to 1>><<set $enemynomax to 1>><<unset $corruptionDancing>><</link>><<promiscuous3>>
	<<elseif $promiscuity lte 34 and $uncomfortable.prostituting is false>>
		<<link [[包间|Brothel Private]]>><<set $phase to 0>><<set $enemyno to 1>><<set $enemynomax to 1>><<unset $corruptionDancing>><<set $desperateaction to 1>><</link>><<promiscuous3>>
		<br>
	<</if>>
<<elseif $danceevent is "rape">>
	<<link [[继续|Brothel Dance Rape]]>><<set $molestationstart to 1>><<unset $corruptionDancing>><</link>>
<<elseif $danceevent is "leighton">>
	<<if $corruptionDancing is 2>>
		史莱姆希望你和更多人共享快乐的时光。
	<<elseif $promiscuity gte 35>>
		<<link [[包间|Leighton Private]]>><<clotheson>><<endevent>><<unset $corruptionDancing>><</link>><<promiscuous3>>
		<br>
	<</if>>
<<elseif $danceevent is "robin">>
	<<if $corruptionDancing is 2>>
		史莱姆希望你和更多人共享快乐的时光。
	<<else>>
		<<link [[包间|Robin Brothel]]>><<clotheson>><<endevent>><<unset $corruptionDancing>><</link>>
	<</if>>

<<elseif $danceevent is 0>>
	<<if $corruptionDancing isnot undefined>>
		你耳中的史莱姆在逼迫着你。
	<<elseif $exposed gte 2 and $exhibitionism lte 74>>
		<<link [[逃跑|Brothel Dressing Room]]>><<clotheson>><<endevent>><<unset $corruptionDancing>><</link>>
	<<elseif $exposed gte 1 and $exhibitionism lte 34>>
		<<link [[逃跑|Brothel Dressing Room]]>><<clotheson>><<endevent>><<unset $corruptionDancing>><</link>>
	<<else>>
		<<link [[停止|Brothel]]>><<clotheson>><<endevent>><<unset $corruptionDancing>><</link>>
	<</if>>
<</if>>
/*More simple setup below */
<<if $danceevent is "rape">>
	<<link [[继续|Beach Party Dance Rape]]>><<set $molestationstart to 1>><</link>>
<<elseif $danceevent is "finish">>
	<<link [[继续|Beach Party]]>><<clotheson>><<endevent>><</link>>
<<elseif $danceevent is 0>>
	<<if $exposed gte 2 and $exhibitionism lte 74>>
		<<link [[逃走|Changing Room]]>><<clotheson>><<endevent>><</link>>
	<<elseif $exposed gte 1 and $exhibitionism lte 34>>
		<<link [[逃走|Changing Room]]>><<clotheson>><<endevent>><</link>>
	<<else>>
		<<link [[停止|Beach Party]]>><<clotheson>><<endevent>><</link>>
	<</if>>
<</if>>

:: Preg


<<print $sexStats.vagina.sperm["plump man"].count>><br>
月经状态: <<print $sexStats.vagina.menstruation.currentState>><br>
经期: <<print $sexStats.vagina.menstruation.currentDay>><br>
